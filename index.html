<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <title>Portfolyo - Projelerim</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    /* Genel */
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: #f5f5f5;
      color: #111;
      padding: 24px;
    }

    header {
      max-width: 960px;
      margin: 0 auto 24px auto;
      display: flex;
      flex-direction: column;
      gap: 12px;
    }
    header h1 {
      font-size: 28px;
      font-weight: 600;
    }
    header p {
      font-size: 14px;
      color: #555;
    }

    /* Filtre butonlarÄ± */
    .filters {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
      margin-top: 8px;
    }
    .filter-btn {
      border: 1px solid #ddd;
      background: #fff;
      padding: 6px 12px;
      border-radius: 999px;
      font-size: 13px;
      cursor: pointer;
      transition: background 0.15s, border-color 0.15s;
    }
    .filter-btn.active {
      background: #111;
      color: #fff;
      border-color: #111;
    }

    /* Proje grid */
    .projects {
      max-width: 960px;
      margin: 0 auto;
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
      gap: 16px;
    }
    .project-card {
      background: #fff;
      border-radius: 14px;
      padding: 12px;
      border: 1px solid #e5e5e5;
      cursor: pointer;
      display: flex;
      flex-direction: column;
      gap: 8px;
      transition: box-shadow 0.15s, transform 0.15s;
    }
    .project-card:hover {
      box-shadow: 0 10px 24px rgba(0,0,0,0.06);
      transform: translateY(-2px);
    }
    .project-cover {
      width: 100%;
      aspect-ratio: 16 / 9;
      border-radius: 10px;
      object-fit: cover;
      background: #eee;
    }
    .project-title {
      font-size: 16px;
      font-weight: 600;
    }
    .project-type {
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      color: #777;
    }
    .project-short {
      font-size: 13px;
      color: #555;
    }

    /* Modal */
    .modal-backdrop {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.4);
      display: none;
      align-items: center;
      justify-content: center;
      padding: 16px;
      z-index: 100;
    }
    .modal-backdrop.show {
      display: flex;
    }
    .modal {
      max-width: 960px;
      width: 100%;
      max-height: 90vh;
      background: #fff;
      border-radius: 16px;
      padding: 16px;
      overflow: auto;
      display: grid;
      grid-template-columns: minmax(0, 2fr) minmax(0, 3fr);
      gap: 16px;
    }
    @media (max-width: 768px) {
      .modal {
        grid-template-columns: 1fr;
      }
    }
    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 8px;
    }
    .modal-title {
      font-size: 20px;
      font-weight: 600;
    }
    .modal-close {
      border: none;
      background: transparent;
      font-size: 20px;
      cursor: pointer;
    }
    .modal-type {
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      color: #777;
      margin-bottom: 8px;
    }
    .modal-description {
      font-size: 14px;
      color: #444;
      line-height: 1.5;
      white-space: pre-wrap;
    }

    /* Galeri */
    .gallery {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }
    .gallery-main {
      width: 100%;
      aspect-ratio: 16/9;
      border-radius: 10px;
      object-fit: cover;
      background: #eee;
    }
    .thumbs {
      display: flex;
      gap: 6px;
      margin-top: 4px;
      flex-wrap: wrap;
    }
    .thumbs img {
      width: 72px;
      height: 48px;
      border-radius: 8px;
      object-fit: cover;
      cursor: pointer;
      border: 1px solid transparent;
    }
    .thumbs img.active {
      border-color: #111;
    }

    /* Video */
    .video-wrapper {
      margin-top: 16px;
    }
    .video-wrapper h3 {
      font-size: 14px;
      margin-bottom: 8px;
    }
    .video-wrapper iframe {
      width: 100%;
      aspect-ratio: 16 / 9;
      border-radius: 10px;
      border: none;
    }

    /* KÃ¼Ã§Ã¼k not */
    .small-note {
      font-size: 11px;
      color: #777;
      margin-top: 4px;
    }
  </style>
</head>
<body>
  <header>
    <h1>Projelerim</h1>
    <p>Sade portfolyo. Projeleri klasÃ¶rlerden otomatik okuyorum. Yeni proje eklemek iÃ§in sadece GitHubâ€™da klasÃ¶r + meta dosyasÄ± oluÅŸturman yeterli.</p>
    <div class="filters">
      <button class="filter-btn active" data-filter="hepsi">Hepsi</button>
      <button class="filter-btn" data-filter="yazilim">YazÄ±lÄ±m</button>
      <button class="filter-btn" data-filter="tasarim">TasarÄ±m</button>
    </div>
    <p class="small-note">Not: Projeler <code>/projects/&lt;proje-adi&gt;/meta.json</code> dosyalarÄ±ndan okunur.</p>
  </header>

  <main class="projects" id="projectsContainer">
    <!-- JS ile doldurulacak -->
  </main>

  <!-- Modal -->
  <div class="modal-backdrop" id="projectModalBackdrop">
    <div class="modal">
      <div class="gallery">
        <img id="modalMainImage" class="gallery-main" alt="" />
        <div class="thumbs" id="modalThumbs"></div>
      </div>
      <div>
        <div class="modal-header">
          <div>
            <div class="modal-type" id="modalType"></div>
            <div class="modal-title" id="modalTitle"></div>
          </div>
          <button class="modal-close" id="modalCloseBtn">&times;</button>
        </div>
        <div class="modal-description" id="modalDescription"></div>
        <div class="video-wrapper" id="modalVideoWrapper" style="display:none;">
          <h3>Video</h3>
          <iframe id="modalVideoIframe" allowfullscreen></iframe>
        </div>
      </div>
    </div>
  </div>

  <script>
    // ðŸ”§ BurayÄ± KENDÄ° bilgilerinle doldur:
    const GITHUB_USER = "GITHUB_KULLANICI_ADIN";      // Ã¶rn: "bahadirkus"
    const GITHUB_REPO  = "REPO_ADI";                  // Ã¶rn: "portfolio-site"
    const BRANCH       = "main";
    const PROJECTS_PATH = "projects";

    const projectsContainer = document.getElementById("projectsContainer");
    const modalBackdrop = document.getElementById("projectModalBackdrop");
    const modalTitle = document.getElementById("modalTitle");
    const modalType = document.getElementById("modalType");
    const modalDescription = document.getElementById("modalDescription");
    const modalMainImage = document.getElementById("modalMainImage");
    const modalThumbs = document.getElementById("modalThumbs");
    const modalVideoWrapper = document.getElementById("modalVideoWrapper");
    const modalVideoIframe = document.getElementById("modalVideoIframe");
    const modalCloseBtn = document.getElementById("modalCloseBtn");

    let allProjects = [];

    async function fetchProjects() {
      const apiUrl = `https://api.github.com/repos/${GITHUB_USER}/${GITHUB_REPO}/contents/${PROJECTS_PATH}?ref=${BRANCH}`;

      const res = await fetch(apiUrl);
      const items = await res.json();

      const folders = items.filter(i => i.type === "dir");
      const projects = [];

      for (const folder of folders) {
        try {
          const folderApi = `https://api.github.com/repos/${GITHUB_USER}/${GITHUB_REPO}/contents/${folder.path}?ref=${BRANCH}`;
          const folderRes = await fetch(folderApi);
          const folderItems = await folderRes.json();

          const metaFile = folderItems.find(f => f.name === "meta.json");
          if (!metaFile || !metaFile.download_url) continue;

          const metaRes = await fetch(metaFile.download_url);
          const meta = await metaRes.json();

          projects.push({
            slug: folder.name,
            path: folder.path,
            ...meta
          });
        } catch (e) {
          console.error("Proje okunurken hata:", folder.name, e);
        }
      }

      allProjects = projects;
      renderProjects("hepsi");
    }

    function renderProjects(filterType) {
      projectsContainer.innerHTML = "";

      const filtered = allProjects.filter(p => {
        if (filterType === "hepsi") return true;
        return (p.type || "").toLowerCase() === filterType;
      });

      if (filtered.length === 0) {
        projectsContainer.innerHTML = "<p>Bu filtreye uygun proje bulunamadÄ±.</p>";
        return;
      }

      for (const project of filtered) {
        const card = document.createElement("article");
        card.className = "project-card";
        card.dataset.slug = project.slug;

        const img = document.createElement("img");
        img.className = "project-cover";
        img.alt = project.title || "";
        img.src = `https://raw.githubusercontent.com/${GITHUB_USER}/${GITHUB_REPO}/${BRANCH}/${PROJECTS_PATH}/${project.slug}/${project.coverImage}`;

        const typeEl = document.createElement("div");
        typeEl.className = "project-type";
        typeEl.textContent = (project.type || "").toUpperCase();

        const titleEl = document.createElement("div");
        titleEl.className = "project-title";
        titleEl.textContent = project.title || "BaÅŸlÄ±ksÄ±z Proje";

        const shortEl = document.createElement("div");
        shortEl.className = "project-short";
        shortEl.textContent = project.shortDescription || "";

        card.appendChild(img);
        card.appendChild(typeEl);
        card.appendChild(titleEl);
        card.appendChild(shortEl);

        card.addEventListener("click", () => openModal(project));
        projectsContainer.appendChild(card);
      }
    }

    function openModal(project) {
      modalTitle.textContent = project.title || "";
      modalType.textContent = (project.type || "").toUpperCase();
      modalDescription.textContent = project.description || project.shortDescription || "";

      const galleryImages = [];
      if (project.coverImage) galleryImages.push(project.coverImage);
      if (Array.isArray(project.gallery)) {
        for (const g of project.gallery) {
          if (g && !galleryImages.includes(g)) galleryImages.push(g);
        }
      }

      modalThumbs.innerHTML = "";
      let mainSrc = "";

      if (galleryImages.length > 0) {
        mainSrc = `https://raw.githubusercontent.com/${GITHUB_USER}/${GITHUB_REPO}/${BRANCH}/${PROJECTS_PATH}/${project.slug}/${galleryImages[0]}`;
        galleryImages.forEach((filename, index) => {
          const src = `https://raw.githubusercontent.com/${GITHUB_USER}/${GITHUB_REPO}/${BRANCH}/${PROJECTS_PATH}/${project.slug}/${filename}`;
          const thumb = document.createElement("img");
          thumb.src = src;
          thumb.alt = project.title || "";
          if (index === 0) thumb.classList.add("active");
          thumb.addEventListener("click", () => {
            modalMainImage.src = src;
            document.querySelectorAll(".thumbs img").forEach(img => img.classList.remove("active"));
            thumb.classList.add("active");
          });
          modalThumbs.appendChild(thumb);
        });
      } else {
        mainSrc = "";
      }

      modalMainImage.src = mainSrc;

      if (project.video && project.video.trim() !== "") {
        modalVideoWrapper.style.display = "block";
        modalVideoIframe.src = project.video;
      } else {
        modalVideoWrapper.style.display = "none";
        modalVideoIframe.src = "";
      }

      modalBackdrop.classList.add("show");
    }

    function closeModal() {
      modalBackdrop.classList.remove("show");
      modalVideoIframe.src = "";
    }

    modalCloseBtn.addEventListener("click", closeModal);
    modalBackdrop.addEventListener("click", (e) => {
      if (e.target === modalBackdrop) closeModal();
    });

    // Filtre butonlarÄ±
    document.querySelectorAll(".filter-btn").forEach(btn => {
      btn.addEventListener("click", () => {
        document.querySelectorAll(".filter-btn").forEach(b => b.classList.remove("active"));
        btn.classList.add("active");
        const type = btn.dataset.filter;
        renderProjects(type);
      });
    });

    // Sayfa aÃ§Ä±lÄ±nca projeleri yÃ¼kle
    fetchProjects().catch(e => console.error(e));
  </script>
</body>
</html>
